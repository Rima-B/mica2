<!--
  ~ Copyright (c) 2015 OBiBa. All rights reserved.
  ~
  ~ This program and the accompanying materials
  ~ are made available under the terms of the GNU Public License v3.0.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div>
  <h2 translate>data-access-config.title</h2>
  <p translate>data-access-config.info</p>

  <obiba-alert id="DataAccessConfigController"></obiba-alert>

  <h3 translate>data-access-config.pdf-template</h3>

  <attachment-input files="dataAccessForm.pdfTemplates" accept="application/pdf" multiple="false"></attachment-input>

  <div class="help-block">
    <span>{{'allowed-file-types' | translate}}<span><strong>{{fileTypes}}</strong></span></span>
  </div>

  <h3 translate>data-access-config.schema-form</h3>

  <tabset class="voffset4">
    <div class="pull-right">
      <button ng-if="selectedTab === 'form-preview'"
        ng-click="testPreview(formPreview)"
        class="btn btn-default btn-sm">
        <span translate>data-access-config.preview.test</span>
      </button>

      <button ng-click="fullscreen(selectedTab)"
        class="btn btn-default btn-sm"
        title="{{'fullscreen' | translate}}">
        <i class="glyphicon glyphicon-fullscreen"></i>
      </button>
    </div>

    <tab ng-click="selectTab('form-schema')" heading="{{'data-access-config.schema.tab' | translate}}">
      <div id="form-schema" ui-ace="ace.options"
        ng-model="form.schema"
        class="form-control form-schema">
      </div>
      <div class="help-block" translate>data-access-config.schema.info</div>
    </tab>
    <tab ng-click="selectTab('form-definition')" heading="{{'data-access-config.definition.tab' | translate}}">
      <div id="form-definition" class="form-control form-definition"
        ui-ace="ace.options"
        ng-model="form.definition">
      </div>
      <div class="help-block" translate>data-access-config.definition.info</div>
    </tab>

    <tab ng-click="selectTab('form-preview')" heading="{{'data-access-config.preview.tab' | translate}}">
      <form id="form-preview" name="formPreview" class="form-preview">
        <div
          sf-model="form.model"
          sf-form="form.definitionJson"
          sf-schema="form.schemaJson">
        </div>
      </form>
    </tab>
    <tab ng-click="selectTab('form-model')" heading="{{'data-access-config.model.tab' | translate}}">
      <div id="form-model" class="form-control form-definition"
        ui-ace="ace.options"
        ng-model="modelPreview">
      </div>
      <div class="help-block" translate>data-access-config.model.info</div>
    </tab>
  </tabset>

  <button ng-click="saveForm()" class="btn btn-primary voffset4">
    <span translate>save</span>
  </button>

</div>
